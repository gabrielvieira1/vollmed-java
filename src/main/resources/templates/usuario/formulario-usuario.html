<!DOCTYPE html>
<html lang="pt" xmlns:th="http://thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
 layout:decorate="~{template.html}">

<head>
 <title>Cadastro de Usu√°rio</title>
</head>

<body>
 <div layout:fragment="conteudo">
  <div class="main-container">
   <div class="page-header">
    <div class="container">
     <h1 class="page-title" th:text="${dados.id == null} ? 'Novo Usu√°rio' : 'Editar Usu√°rio'"></h1>
    </div>
   </div>

   <main class="container">
    <div class="modern-card">
     <div th:if="${erro}" class="modern-alert"
      style="background: #f8d7da; color: #721c24; margin-bottom: 20px; padding: 15px; border-radius: 8px;">
      <strong>‚ùå Erro!</strong> <span th:text="${erro}"></span>
     </div>

     <form th:action="@{/usuarios}" th:object="${dados}" method="POST">
      <input type="hidden" th:field="*{id}">

      <div class="modern-form-row">
       <div class="modern-form-group">
        <label for="nome">Nome Completo *</label>
        <input type="text" id="nome" name="nome" th:field="*{nome}" placeholder="Digite o nome completo" required>
       </div>
      </div>

      <div class="modern-form-row">
       <div class="modern-form-group">
        <label for="email">Email *</label>
        <input type="email" id="email" name="email" th:field="*{email}" placeholder="usuario@email.com" required>
       </div>
      </div>

      <div class="modern-form-row">
       <div class="modern-form-group">
        <label for="perfil">Perfil de Acesso *</label>
        <select id="perfil" name="perfil" th:field="*{perfil}" required>
         <option value="">Selecione um perfil</option>
         <option th:each="perfil : ${perfis}" th:value="${perfil}" th:text="${perfil.descricao}"></option>
        </select>

        <!-- Descri√ß√£o dos perfis -->
        <div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px; font-size: 0.9em;">
         <strong>Permiss√µes dos perfis:</strong>
         <ul style="margin: 5px 0; padding-left: 20px;">
          <li><strong>Admin:</strong> Acesso total ao sistema</li>
          <li><strong>M√©dico:</strong> Gerenciar consultas e pacientes</li>
          <li><strong>Recepcionista:</strong> Agendar consultas e cadastrar pacientes</li>
          <li><strong>Paciente:</strong> Visualizar suas consultas</li>
         </ul>
        </div>
       </div>
      </div>

      <div class="modern-form-row">
       <div class="modern-form-group">
        <label for="senha">
         <span th:if="${dados.id == null}">Senha *</span>
         <span th:if="${dados.id != null}">Nova Senha (deixe em branco para n√£o alterar)</span>
        </label>
        <input type="password" id="senha" name="senha" th:field="*{senha}" placeholder="M√≠nimo 6 caracteres"
         th:required="${dados.id == null}">
        <small style="color: #666;">
         <span th:if="${dados.id == null}">‚ö†Ô∏è Senha obrigat√≥ria para novo usu√°rio</span>
         <span th:if="${dados.id != null}">üí° Preencha apenas se quiser alterar a senha</span>
        </small>
       </div>
      </div>

      <div class="modern-form-actions">
       <button type="submit" class="modern-btn modern-btn-primary">
        <span th:if="${dados.id == null}">Cadastrar Usu√°rio</span>
        <span th:if="${dados.id != null}">Salvar Altera√ß√µes</span>
       </button>
       <a href="listagem-usuarios.html" th:href="@{/usuarios}" class="modern-btn modern-btn-secondary">
        Cancelar
       </a>
      </div>
     </form>
    </div>
   </main>
  </div>
 </div>
</body>

</html>